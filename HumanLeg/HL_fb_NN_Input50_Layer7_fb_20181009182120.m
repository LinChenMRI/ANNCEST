function [Y,Xf,Af] = HL_fb_NN_Input50_Layer7_fb_20181009182120(X,~,~)
%HL_FB_NN_INPUT50_LAYER7_FB_20181009182120 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 09-Oct-2018 18:23:04.
% 
% [Y] = HL_fb_NN_Input50_Layer7_fb_20181009182120(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 50xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.239233968441743;0.254433067672713;0.281955623253196;0.309433000374225;0.325312487361524;0.349288638875955;0.366942033599808;0.387392468923731;0.409366150159471;0.421593338240968;0.441544112924264;0.456015147596328;0.465922527064009;0.494782129523094;0.505092170539569;0.525962690709014;0.530103067703917;0.540839406582429;0.559072671447044;0.564299674085212;0.572347794190598;0.584935142706206;0.595756701405807;0.607234708183441;0.61528951249975;0.622016842447968;0.621009418082849;0.631861254994245;0.635681552416919;0.638193732988036;0.635588946722686;0.639022378965164;0.640938662520854;0.648239611625448;0.64859212330811;0.650891712141946;0.654109068707685;0.653817283467663;0.668275687882982;0.668380767815311;0.680111474628002;0.691544290311852;0.706839415385892;0.709435566009557;0.718146880975676;0.726885919636099;0.734569221671883;0.744838560763892;0.749761424689848;0.749838811553729];
x1_step1.gain = [3.53698942295147;3.6459290879825;3.72795208883749;3.95898828066605;4.0450361099947;4.20317364529759;4.29116094126585;4.49388229466214;4.69229933734629;4.76074383609378;5.01917279114901;5.17427939274765;5.21837155101685;5.58121152571696;5.68274026582846;6.03365913336881;6.15552074648807;6.23391042792375;6.54937769761364;6.57997125944876;6.70843830573376;7.13259785265279;7.26734313261269;7.66590049909969;7.71615588933261;7.74528168400795;7.61718438351102;8.1167836340031;8.20061299716654;8.07971860349611;7.84759202606327;8.08859248789667;8.08158624362279;8.07660465148611;8.19078994341533;8.29551851948452;8.2820687244632;8.22413750842921;8.74247480687487;8.71528466701423;9.12714346241772;9.31254732407222;10.3977910088432;9.9365367913205;10.2876820441959;11.146783872866;11.5751049236088;12.3423565784912;12.478216686025;12.4309936896026];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.48088331775948789382;-1.1062740326823190529;0.16279922922075387715;-0.10863541377473946714;0.13081031127000761205;-0.82903531217499815131;-0.34415092112210704522];
IW1_1 = [-0.15606610391355571488 -0.13437169100598597704 -0.093620334969736387909 -0.089624091740256234262 -0.08207720841323729033 -0.059809645437119363098 -0.030396065643140793983 -0.013175916205804192455 -0.004463031316155730184 -0.0079450888832453669258 0.026406650496012012974 0.015323354546902891865 0.026557008282998263715 0.043021614736507465815 0.058441064092706968003 0.03610228547361552659 0.031194369559152897164 0.024624003354698942303 0.004264764260601550637 0.0063460557457474800133 -0.011169493615558421032 -0.0014940554836718477911 -0.022817027292572039654 -0.054891682818762339846 -0.087588411009809158392 -0.073766929157070837419 -0.10503109518300692005 -0.12301880651918971343 -0.11564940456609242025 -0.094480022575391203743 -0.13174867372972007273 -0.11973984459259702506 -0.098966418568702432812 -0.090161733525084220009 -0.044388410096684087491 -0.0036454173911056545615 0.033827739778623085176 0.056696486908992906051 0.069149911521550894156 0.11614661269738668636 0.10332524588897898377 0.11570917572673053431 0.10719494153900148425 0.10968854392388012464 0.092912686190810417353 0.098109828267379628475 0.11741743764557907581 0.093515225313240177285 0.094385015016261120113 0.1023701727292150726;0.41139810084296835058 0.40748855180139809118 0.40040938476386206402 0.34599719729208028296 0.36249055129023016741 0.30962767065541607625 0.27933701093029039697 0.24396292468357930194 0.20876678768224590788 0.14086425766078283783 0.11732375161819352805 0.071854761186614032886 0.015970046996906815673 -0.012132478212253017605 -0.083762224819251218655 -0.10989343353501354605 -0.16956764186596712252 -0.20655167899571166834 -0.24433044805819115197 -0.29400470151176355538 -0.29632621600143110863 -0.33868277295019960649 -0.30007746342398633477 -0.28125835934703308228 -0.27419441237702335545 -0.28343520634764374222 -0.26943074596952726329 -0.23394212417624915545 -0.22936344651391554761 -0.20776021690937801489 -0.12337842809994933879 -0.093714519554668279655 -0.027448641564576894969 0.041273255615185057421 0.068080400542268063036 0.099785145581402431847 0.12393654599314823939 0.14633443284665495487 0.14605268741421606471 0.12821690293412990602 0.12401098104541660727 0.1044338036481402554 0.10107961405242452124 0.11208993981891511582 0.12978355678913547355 0.08818492700368123216 0.061491762795842438982 0.067108956269925898463 0.05985144648863247735 0.061572403040002415819;-0.02697087339250260965 -0.013855467286553435277 -0.017615522053578205885 -0.011365962238235372689 -0.00091896535096202863931 -0.0050971323296441564676 -0.0065808911889735808784 -0.0047429679510319492156 -0.0051092672492653052468 0.00014015315750141719335 -0.0033265277025424696417 -0.0037330657850451567405 -0.0012891399735261591195 -0.0068581798643842445742 -0.010053172484751649388 -0.0048146966320037109036 -0.00379576738907425092 0.0010435999650648852995 0.00058920706537877900848 -9.0570925466405924776e-05 0.0094770685795186535016 0.0071420746758533827994 0.011121980791092132834 0.020973957968592988471 0.020186302625321304871 0.013281299334355024452 0.016165447573505714596 0.008111459357910267079 -0.0037610233341179430053 -0.019138553702057942152 -0.023029859701602962974 -0.035955942075381455703 -0.039629451038275462227 -0.039861311319652925622 -0.045331371700120429158 -0.041829787910238676318 -0.03957396557451423047 -0.03076272427817570293 -0.023867137469859679016 -0.023244069378988343327 -0.012140007688226957597 -0.010111082744336568479 0.00038493957080279667983 0.0032977796840459095741 0.0094852422459881374772 0.013238613880997198574 0.01165853299018675647 0.017376742785979885919 0.017761164283592170005 0.0221340679984692347;0.028932770724878337926 0.017991261951332340741 0.018865119387526902567 0.015275079501972956691 0.011809728040420148371 0.0127982746644945862 0.0065685009944667039836 0.0028161738531003051821 0.0009834214825921484826 0.00079504718132477529644 -0.0043381292965197406492 -0.0044231278405982470472 -0.003958599754248684488 0.0037384794884113485385 0.0014271326063059358059 0.01127796654363511647 0.0082968006055580446889 0.012262366438957455692 0.026685742763371340242 0.028227374579587460879 0.036296075940904677648 0.03567075341792983606 0.04953212705447933295 0.058609078997058750016 0.06622941457238593066 0.067915636662421050018 0.067508441997559578973 0.069946314692958422299 0.064915959624142774431 0.063225738570522382886 0.061266394828872652867 0.052833878152697626163 0.05044337992649845781 0.055325048841253915421 0.046668753819230981983 0.035558714328353016598 0.029226722983461558836 0.02012671599501118444 0.020586358451221687532 0.0033161223761753880548 0.0035021559365681874387 0.0050832170468811770092 0.0044687070750702561489 0.0070087315372589125209 0.0064065420919955122156 -0.004987732674490669843 -0.0071648401429296997706 -0.0030590337139406063513 -0.0038184234979364013556 -0.010820425367749637868;-0.48262250621106767001 -0.43037150571889942752 -0.36084789667921701728 -0.26941212911898004823 -0.21618292587115831016 -0.14261298425417673341 -0.080844312202863366501 -0.036493441101723693432 0.021399426787461751226 0.088561828927252492227 0.10529722772776245465 0.15068068304299525595 0.21082788837413549143 0.23777382526344711944 0.26935276844233946303 0.32124767452979163807 0.36826399195933501307 0.39019920064675273075 0.4300699009460098865 0.45244243709229664541 0.42401238605272117965 0.41845898309333834364 0.36185173169798962034 0.33460753610655530332 0.27592964390109503414 0.20371590364680378094 0.1175502235658678063 0.042452611186793540177 -0.056649648919632533683 -0.1388782023282303657 -0.22997910906021104549 -0.32798441202378847414 -0.37814028133888832883 -0.42574466558389612025 -0.47332174091420803341 -0.48184831861031002243 -0.4864020661671702439 -0.45551755218344575082 -0.3980963366763628497 -0.34151747224276940429 -0.25345028978170153211 -0.16596200946370606721 -0.091394378470040171791 -0.037725770328792290753 0.0082678681624936099792 0.056577815821481039493 0.089070518562239200944 0.12239376512288793752 0.16353986258772312823 0.16090923796384806743;0.1656647417805900413 0.19324490232574914605 0.21377840155626801066 0.16449837488915100558 0.13108810832541115121 0.11461731868112315369 0.13178001769681063626 0.10671858110590866364 0.075462597648946208584 0.0040656363355002240328 0.02394473176401499051 -0.037654268279516803219 -0.061799275784817787882 -0.11086284895377696014 -0.13356069056113842319 -0.25140952204948047166 -0.29003375345801329921 -0.3388044123269831065 -0.43335021983307864257 -0.45646753062942430068 -0.50437565647949433867 -0.48180512782124151894 -0.4834876945444620544 -0.54618931238169310394 -0.5146990139669337383 -0.4274568160458421251 -0.39411433914999949302 -0.32585571524752104944 -0.18374559144219534956 -0.044529535342650056196 0.010093624618806286419 0.18999596676647645399 0.29474780477277079394 0.37882994199247105316 0.50437079588112176953 0.58567915261381708891 0.62042309187214494948 0.61231103437042055937 0.55501248642592038163 0.57042036615838664915 0.43468753499871798374 0.34892814248083492412 0.23944875941217172444 0.17912246511771273694 0.089283247682499983222 0.046880989235434912532 0.033079793188719772146 -0.050887587896228332618 -0.094443517917813760154 -0.093120137013317116903;0.087539619806034141281 0.053922940334862154432 0.050183381544811930808 0.035977186790909401748 0.010450954007061969211 0.010196370329359393664 0.0035483596677355695899 -0.0023741104399070856075 -0.0036597218287581739608 -0.013221656750930302349 -0.019640727662789934233 -0.018855697589033167116 -0.02644106929970990727 -0.013755969288403521386 -0.01815625741798557527 -0.017095611356152829591 -0.029118923756368066819 -0.024189476420444003951 -0.022732876458472505571 -0.024274991454308333244 -0.034816988306281743126 -0.035157159206234522841 -0.032102125096945176297 -0.037525948871422735997 -0.02520381366778807683 -0.003900596652062180824 0.0060953619418635304056 0.030624549864539406252 0.0605819193216780294 0.090396109968415308544 0.10646161831427695954 0.12423235262112021504 0.12697807628026019922 0.1264888547696407517 0.11403144590394292957 0.087838749154536821528 0.065684272989946376753 0.034262751062521912271 0.014175494070765017399 -0.0066122861273591364631 -0.02514481416647596293 -0.028362354297941164138 -0.044476025737158940421 -0.047809633535681426986 -0.050775568738878229524 -0.063819062428057279912 -0.069165770376787311102 -0.07305533123104326898 -0.072143360717469254273 -0.081025627491996543572];

% Layer 2
b2 = 0.59252364990597716776;
LW2_1 = [-0.56014817138968187038 1.071623198270791999 0.23004393477316642524 0.09186662441655557565 1.753210781272993346 0.93248850016273432395 -0.45019499186692757409];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00997505113969996;
y1_step1.xoffset = -17.2875671115262;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
