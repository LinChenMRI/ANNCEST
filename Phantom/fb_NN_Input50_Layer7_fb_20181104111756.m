function [Y,Xf,Af] = fb_NN_Input50_Layer7_fb_20181104111756(X,~,~)
%FB_NN_INPUT50_LAYER7_FB_20181104111756 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Nov-2018 11:44:31.
% 
% [Y] = fb_NN_Input50_Layer7_fb_20181104111756(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 50xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0729247175037787;0.178282313189777;0.299244062513112;0.407549437895104;0.498709911335852;0.575275266770725;0.637313367605373;0.682006395937553;0.720640832639236;0.749694497434049;0.771880274617689;0.790322994288391;0.806569501273184;0.812398040017593;0.808926948516297;0.808383146811244;0.808774595076165;0.807743823189116;0.80773264355027;0.807302209298518;0.806508538105197;0.806949549517941;0.80851528601239;0.806632380774305;0.808476956076085;0.808468164324625;0.808549072013256;0.812030590837194;0.812383031992557;0.811291318059216;0.811814277579579;0.810189525104771;0.810840433473759;0.812117752868335;0.809862393141246;0.811696511949399;0.816707813826149;0.833854485825402;0.857196693039001;0.878378893003495;0.894983877891657;0.91005754356022;0.922166902912498;0.931633047908608;0.940750405781915;0.946993376813479;0.952202465514613;0.959059107552302;0.96430246032489;0.965902688028614];
x1_step1.gain = [2.32586672376029;2.61883265172443;3.07452566774418;3.64503507931867;4.32150725586184;5.14243268644615;6.03053487197486;6.92009684183233;7.955189583762;8.79448534501259;9.74802904578812;10.6672574483497;11.5239912668608;11.9874342700011;11.7012748934594;11.5761515035528;11.560879096601;11.4443210381669;11.3676156644139;11.2797920815681;11.2288583914825;11.2262650490042;11.3599656712744;11.2499461509573;11.3263853672431;11.2640955901356;11.3118734013535;11.4504379970897;11.3834805998145;11.1322539002797;11.0774354215607;10.931692743802;10.8903875540649;10.8798862040678;10.7623807268894;10.7755829675057;11.0166908975686;12.1376768902066;14.1714797915819;16.5520212861965;19.1675147134236;22.2894274321491;25.777047458364;28.8432862703376;33.3207024057174;37.4286641329833;41.3403350459133;46.8631905559151;54.1472727990131;54.5505417943901];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.25312715495738008498;0.071945140178878083659;0.9937538610561551522;-1.834482609170443812;-1.6628733556431529728;0.006880710901169888663;-1.2086398918712866202];
IW1_1 = [-0.76078308357956958563 0.54261694498588775026 0.26392014991947576608 0.44622163695534544647 -0.16645163943730079126 -0.63150447648274043999 -0.68148112995219933818 -0.78470725510070937769 -0.71866799465344255449 -0.64839750156061115582 -0.41513333242942018764 -0.51741889496425053085 0.26088045265489867575 0.4077068042356676858 0.41874905251379912485 1.0362929750181433253 1.1984882790729629587 1.6024502989882063453 1.5356409782389544016 1.2396483860595990389 0.6523267573982028944 0.13323288028056062826 -0.26218255977479260066 -0.64448146501167125066 -0.92095301053827050008 -0.57759835239764645287 -0.80097697410215928926 -0.56628552458384406876 -1.0143229871685868204 -0.82902531348660524202 -0.50618664762469101071 -0.086993385587155899752 0.18347682952576666038 0.55498909569925314322 1.2017758237480840044 1.4170129307708774213 1.3295512420135771059 0.42559819202475174249 -0.17728492148619309776 -0.31312162403063270588 -0.45645069170276025838 -0.28803324440408711871 -0.3213178753512843655 -0.34497923187120060895 -0.19455586060705074014 -0.10293307791311302746 -0.12599488835875100046 -0.11543701308638538994 -0.08480458902939831678 -0.076335832948954629451;-0.067048054455309508137 0.1257376334445195476 0.18500238682936628876 0.20688030760855818935 0.12606715981527613635 0.10241218440528099265 0.036543751698699666886 -0.065057084032539458374 -0.059079594696868666104 -0.099948485805741810184 -0.090084931782500377029 -0.14418723094162588794 -0.12873198189000015224 -0.11385676898594833395 -0.18613463890461304229 -0.13713475736959593321 -0.068045078243105600047 0.063519089810080475722 0.16521551188584576719 0.23121711973915370919 0.21969174058524648663 0.18760074879600341369 0.14251989410835674832 0.11325653674685082217 0.027614541063303469498 0.022504909954318724763 -0.098327644550410153723 -0.15712351666992371846 -0.26691950260761726499 -0.34499258598890436556 -0.31832308327130409698 -0.18906886320959809256 -0.04101580991105455154 0.1182595423742438534 0.23650030279405154232 0.21435333778893356227 0.10418124064060974021 0.027279691721848738778 -0.044191423385758120401 -0.039598311398295858721 -0.066259948363954088157 -0.025810631379915981165 -0.024074589465886378492 -0.030413717752666002275 -0.016902971723551672711 -0.017416333216524210875 -0.0094558167696367143029 -0.0060552827212935226783 -0.00548952214083287416 -0.003956595648757694518;-0.33331618363388537674 0.19105262681141604864 0.057089913222864573095 0.046794770893459881889 -0.12051927709016406476 -0.077236822155429762926 -0.041161380847655387738 -0.0033686544608050299904 -0.019109045496988903007 0.024526019961766502842 0.077828649551764952919 0.12374757343708181478 0.11864588243376793242 0.15013644164419215343 0.088166290373009673087 0.054641506593313127205 -0.044118693503832927261 -0.152222561138661866 -0.13192839743482731585 -0.11313694329292220409 -0.024987369015127037369 0.052302730869024725846 0.093749696908666135808 0.1322355045580489441 0.11045932092281493531 0.064285177882716232345 -0.050101868613688121945 -0.20514800629366136686 -0.25946053940553698292 -0.27140805213794716444 -0.24221624413302661472 -0.22076337121520497875 -0.16253562162536983049 -0.064612233211920916398 0.12983078588293375799 0.26045315743526264995 0.32165932891007686933 0.21332106541718473536 0.083918536900931803291 0.043353547586547740156 0.012385040681954477201 0.013938255236128941142 0.0074909180448187537987 -0.0025239020639485497573 -0.0088458870365830961219 -0.0064874116803514594171 0.0067099782732947758218 -0.0090408708404116945589 0.0028547641992991974573 0.005959372949021616607;-0.25296434362099384785 0.041128155448809530781 0.22577559376762521004 0.35268587850922872295 0.34801328244366563913 0.31815674804560112321 0.15722124866017497813 -0.11395098858577074052 -0.050734434461503170877 -0.12427130662993784993 -0.13661321310115226435 -0.24915915218407416742 -0.26110623161850754492 -0.3085599877939486646 -0.42549412969393951567 -0.31773580017143365772 -0.10875604592171658758 0.27583785545711136944 0.35854287753324665111 0.36819202051549904109 0.23011426793319025852 0.12364753520866911263 0.13032989582596191114 0.1252837182414763828 -0.10191209773380661974 -0.101962600646090501 -0.20831087369798156894 -0.20886878012067139343 -0.39429529816570246803 -0.625491068115727189 -0.63658466047462136661 -0.39478218837262391006 -0.0071715451466518639195 0.32361979186879774595 0.40088938260216377962 0.2156790474747493358 -0.017179643142389115773 -0.05007321333299915439 -0.03179883694004122241 -0.030104300251537874367 -0.061431659841037669634 -0.016932717514782362478 -0.0076775857342360935912 -0.016026636522567350857 -0.0049424700664086086699 -0.0087378221212991331879 -0.0101030925753249224 0.0055142154988987376885 -0.0041718284158112316218 -0.0054741295067584948633;-0.06989023725403448184 0.28748068302842250121 0.115044484264334404 -0.044902403811484817298 -0.11675912698224437392 -0.15746402787735441775 -0.15023198416428770741 -0.19531298918617065463 -0.13334689763245741179 -0.1010976199273830034 -0.046910742309202044242 -0.052463125231721315089 -0.043704806716013691603 -0.020564029126370605982 -0.024511006510190790769 -0.056871194422493533127 -0.083492514819327026676 -0.083029448129919303234 -0.081009170417342443726 -0.032707967385559415241 0.089843471478042599698 0.2120811786647703312 0.33573803017227626944 0.47604052757592446588 0.48572661194548261143 0.47942543692010736178 0.38212260559365701651 0.17583975684470465328 0.020972025193408256466 -0.19126666990622473441 -0.32625572415552045458 -0.33024332237914888477 -0.31685439177960422752 -0.29655641683797456798 -0.23311885489827044449 -0.17088864879709350642 -0.12658352639167055886 -0.021605528772405950544 0.057285539153252025557 0.077876599624932707489 0.055761165491187127119 0.048280094562876303688 0.034505829868963666662 0.015759119230708686782 0.0068156685239921079369 0.0028856405728148195287 0.011490343425007761707 -0.0052908096505413088062 -0.003216416887758485367 -0.0019681320511410619126;0.10885331480507168256 0.12183181599256877325 0.20639022354352742905 0.22181406691145677534 0.18024549126748160011 0.16211096726289353498 0.050200025151247905375 -0.11423949819511303172 -0.064457846640353158585 -0.13725370023951793952 -0.13199288672243203457 -0.22590741939235717273 -0.1946600783796331724 -0.1766672459900772707 -0.25212171452960052687 -0.15791391757028672149 0.0033914425712855307549 0.2550778008075030856 0.37204568462892284586 0.44433416855138241353 0.37799388597982130911 0.29430584607967313904 0.23162199209853118198 0.19001088731700124801 0.063625683525699625043 0.054674800978993007283 -0.10343832704628000418 -0.17220909115572005654 -0.3581053497710551814 -0.50359694245136132906 -0.47738023089804892951 -0.26029315287325988093 -0.017468637452145763939 0.22003441073057294908 0.33872855962412584674 0.24871082227847496338 0.050857716956179042922 -0.028135679983537716792 -0.083317539846630622735 -0.072343865749473199034 -0.10016781704450362922 -0.040111630598269748527 -0.037647774189461413741 -0.042473078916308845687 -0.021450838821054762223 -0.021681320174369852344 -0.017536511204984967655 -0.0039341399646346079944 -0.0084551257610823195299 -0.0080275795531707487551;0.39276131981167511364 -0.11480928781607885325 -0.24813714062168762409 -0.25501000487061364908 -0.14946693205399402826 -0.074224538292208833146 -0.031836311841218455088 0.071132580208268486599 0.096446734793676658359 0.11844914298842811051 0.12144968017411798822 0.15425046696030100812 0.19158362035991252648 0.19890411524209042349 0.27564874564441288474 0.30133274039384705389 0.32345822436987897719 0.28423951272456293715 0.17286597784089180463 0.068912765840546341689 -0.044504667660782752658 -0.14730335239870281927 -0.19684539268291592617 -0.2837457322969919038 -0.26211638694811151273 -0.28900228636700825424 -0.2028956238981804161 -0.14076908785218633646 -0.073578526939838337362 0.043785975874025377663 0.096650461522276839843 0.073273234884038931924 0.026380791348136253122 -0.028766049526963512889 -0.067482334674704921862 -0.054566905384427058512 0.0066903188035498037389 -0.014279661679342903896 -0.011674004794985764696 -0.039557888367428364895 -0.008005045087753912339 -0.02237573001783445259 -0.022383388934296432476 -0.0067543719397436937854 -0.0057909307978282215795 0.0078462733993006385236 -0.0081100321398067387602 0.0024985842406594804994 0.00046089561693330913759 -0.0012539096153643578772];

% Layer 2
b2 = 6.0321781106532181838;
LW2_1 = [-0.060062509051085448408 2.8565057557186603887 -1.6806884354530267078 0.49776765905635050879 3.1294921531532708947 -1.6362437091989938676 1.8664239722930853205];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0250683709767249;
y1_step1.xoffset = 5.38367472470042;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
