function [Y,Xf,Af] = kba_NN_Input50_Layer7_kba_20181104111756(X,~,~)
%KBA_NN_INPUT50_LAYER7_KBA_20181104111756 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Nov-2018 11:36:59.
% 
% [Y] = kba_NN_Input50_Layer7_kba_20181104111756(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 50xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0729247175037787;0.178282313189777;0.299244062513112;0.407549437895104;0.498709911335852;0.575275266770725;0.637313367605373;0.682006395937553;0.720640832639236;0.749694497434049;0.771880274617689;0.790322994288391;0.806569501273184;0.812398040017593;0.808926948516297;0.808383146811244;0.808774595076165;0.807743823189116;0.80773264355027;0.807302209298518;0.806508538105197;0.806949549517941;0.80851528601239;0.806632380774305;0.808476956076085;0.808468164324625;0.808549072013256;0.812030590837194;0.812383031992557;0.811291318059216;0.811814277579579;0.810189525104771;0.810840433473759;0.812117752868335;0.809862393141246;0.811696511949399;0.816707813826149;0.833854485825402;0.857196693039001;0.878378893003495;0.894983877891657;0.91005754356022;0.922166902912498;0.931633047908608;0.940750405781915;0.946993376813479;0.952202465514613;0.959059107552302;0.96430246032489;0.965902688028614];
x1_step1.gain = [2.32586672376029;2.61883265172443;3.07452566774418;3.64503507931867;4.32150725586184;5.14243268644615;6.03053487197486;6.92009684183233;7.955189583762;8.79448534501259;9.74802904578812;10.6672574483497;11.5239912668608;11.9874342700011;11.7012748934594;11.5761515035528;11.560879096601;11.4443210381669;11.3676156644139;11.2797920815681;11.2288583914825;11.2262650490042;11.3599656712744;11.2499461509573;11.3263853672431;11.2640955901356;11.3118734013535;11.4504379970897;11.3834805998145;11.1322539002797;11.0774354215607;10.931692743802;10.8903875540649;10.8798862040678;10.7623807268894;10.7755829675057;11.0166908975686;12.1376768902066;14.1714797915819;16.5520212861965;19.1675147134236;22.2894274321491;25.777047458364;28.8432862703376;33.3207024057174;37.4286641329833;41.3403350459133;46.8631905559151;54.1472727990131;54.5505417943901];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.1280057092044462053;2.5488928424913561699;-5.8024985165858664615;-5.5363180322485217033;6.2318150289949780785;-0.33240827696784236434;3.3339676013460595172];
IW1_1 = [0.44783001656793036682 0.37288455609026582849 0.14137615500792358181 -0.13773153459779982621 -0.31924301261168963606 -0.47824461266679779703 -0.44083424780499974593 -0.28858788411490959858 -0.28133403630012349117 -0.19532135981959111715 -0.12529531242017580284 -0.12168254589915969421 -0.045209952446819218208 -0.030119694756326451796 0.090326456757249179441 0.020950576734096820058 -0.04449552105011531089 0.023170923224608345331 -0.0088668114516836041977 0.088426360038675877462 0.099446968953954273385 0.14012849580927952409 0.15787197624719814804 0.10825423305116350925 0.13150301788067261799 0.10421200709021459507 0.18464689115134277908 0.21803097830798776058 0.24336087444632190091 0.18333122751724209576 0.27646371121538371174 0.26832140479619703832 0.15589936060447481814 0.13279487373250231652 0.060358159499107472135 0.089771096788312618187 0.16397571543978339825 0.07284683592328242141 0.0098138172075137638378 -0.051747592317458311617 -0.052135551682437143717 -0.058059923354275289054 -0.085579761449821670216 -0.056612503181727814872 -0.050659549141775131464 -0.026991957495718744281 -0.0085635216611007619614 -0.0099293191517793102929 -0.01591009770657251382 -0.014309059439477047476;-0.47122478214785840089 -0.36776977113284353704 -0.1429631851964288658 0.13307055282672319851 0.32275747561044609846 0.49534387702929749686 0.45690214365261205831 0.29595073603537980222 0.29448743631490531536 0.20679915967923187536 0.13410707117624995344 0.13464323133058969661 0.052714362180148723047 0.038071488897912515725 -0.08988825431948456457 -0.01472737984135942188 0.047490791137471330408 -0.027880730467592079042 0.0055269012882202782355 -0.098047376048503109836 -0.1067276252293695854 -0.14479996830736621694 -0.16194052687562987547 -0.10569795972059663203 -0.13547228214044781947 -0.1093488834122793435 -0.19903803166741079744 -0.23590539892092785013 -0.2656540988569712769 -0.19861101968886493707 -0.29435381056138870681 -0.28235344100044079685 -0.15943645080416665727 -0.13318609776541040501 -0.054200070582498455218 -0.08531201209718725087 -0.16968271075426452632 -0.072307360703149206604 -0.0047497023818502039777 0.057725466849606742181 0.0575417355950005871 0.063566386483961109799 0.092824165540798697638 0.060527118169470678355 0.05503090754228707332 0.029194814131705097704 0.0087024847221309278855 0.010515467764038248163 0.016488384417653392799 0.015865454609350376769;1.6560991403471059247 0.85343451149537508105 0.070156577447956863791 -0.56778050617456410354 -0.72212421541568705408 -0.39371656884207312244 -0.37245351539927801232 -0.3908900633575548289 -0.20262140010120471834 -0.17646679175902993397 0.020185726804805154133 0.15188544620854896317 0.078967503723197010612 0.3234536360013678391 0.086206640248098098667 0.10350613745329678705 0.017492901243364885472 -0.24071243019212187897 -0.26587075076702793019 -0.096921219832260138705 0.025235425874773672467 0.38217060939025082611 0.42471011019975035694 0.63303749549466836744 0.78913863684772500573 0.57928482258376057246 0.51563329372159172337 0.33558953579699157821 0.10090922320218038977 0.032553261498192868906 0.012038630732467543033 -0.02861976643900157255 0.037716365900843526471 -0.12359600124311523328 -0.00099526683376850418397 -0.074071275562867397446 -0.24000321736397048356 -0.19195797004348791326 0.045484110309874536959 -0.019317641764906048202 0.034975626595188269441 0.025576099662063013496 0.057036156296777544561 0.04163779720447894489 0.017791859529255840688 0.038645484493287723948 -0.03750192031456685976 -0.031243663329700990111 -0.020222038650868485316 0.023120376653915673121;0.67489896824466300007 0.94596481034740587113 0.67895119630716105341 0.19717566594610005937 -0.10071593236813783379 -0.24674529586217436306 -0.27182802466687433496 -0.2315238453497421578 -0.20141614287696632535 -0.15694150332905870693 -0.093110206478964702148 -0.043451707689514756927 -0.01202051469985613609 0.012253131744817584783 0.063335415822592486257 0.035475319242567839029 -0.022295705748632842214 -0.042138227045532813952 -0.059269468317209327013 -0.0258387925730742124 -0.030265757353349156261 0.014939171168414736371 0.012271217635071419993 -0.016716075957841514815 -0.034905425572392088929 -0.07294971797077938469 -0.024442190541539249998 0.011151472369335743359 0.034390336185588100959 0.066479427279378860982 0.15812176499160288112 0.20325825256486435011 0.18964793208037605821 0.17520911804364511233 0.17274343138192749247 0.17119354867905184348 0.15037586466782854044 0.068419652027508201519 0.036279391043826887675 -0.020539961488918241639 -0.018071552810841214759 -0.023364993116993137967 -0.036033705064164714416 -0.027516364930650863418 -0.021153072943937506478 -0.013202150088573559247 -0.010897956319780037829 -0.0090108599090398255882 -0.013271265837492373166 -0.005653602264601952955;-0.67082504560029543317 -0.3755293431377841884 0.19039432861213692605 0.49418432998094175002 0.60791432946196199971 0.35527367602711512617 0.2504545945433634957 0.28396758637675251213 0.12109978769049421776 0.010111508549947415686 -0.10860744953294278192 -0.16918552688540733353 -0.15894947669843770277 -0.32475798255383075963 -0.21555623990907571419 -0.18578944386534898547 0.008209274209026727262 0.10911793896330850007 0.11314566304857043288 -0.097237280454062408053 -0.16692666717564963452 -0.3838717234793561639 -0.42044883469240035279 -0.55823901670645503792 -0.54717683208091238978 -0.45320687961015182488 -0.27638776539165560431 -0.14163434890034681812 0.038324219689624523799 0.077642749503782429454 -0.00063485526129680876738 0.04502643180045881599 -0.051245063799759231482 -0.12098327490985751054 -0.18283110509108455033 -0.13286867995067727644 -0.0537476460456709354 -0.072895160630529184931 -0.15938523271415949711 0.013695624401036438425 -0.042644292283067389282 -0.0073265082545905801936 -0.0039986471299650839725 -0.0055226389066373856793 0.0011267526806241511851 -0.017809237278577767088 0.035782231039746550949 0.01242257018818755665 0.02528076423693923977 -0.016686337163253194688;-0.14784285820225179231 0.22142383493528225435 0.19658915759480286023 0.023201389206274441318 -0.056055596604124340032 -0.099055944683043545274 -0.12285206507463504455 -0.092516680119419048012 -0.074490874743069909747 -0.057974610869785066225 -0.04101202534442625891 -0.019816940086463619153 -0.0051459600549155822685 0.0018846630403189328345 0.033481701074858379041 0.038233835480919187155 0.026506849216201368302 0.012053561948686685595 -0.0087997614382306493797 -0.034808973886302579936 -0.04450704562041171708 -0.032545538709158085278 -0.032460435374157319 -0.025562836009092336498 -0.0093912786725939851468 0.0020126678769451554832 0.041727708181231962237 0.067083798625470633659 0.068640196007228523878 0.053724736952849058702 0.048501592696069996402 0.049096591715380284715 0.028454467219682550577 0.022761935262684891701 0.023015418086284402527 0.023826801716671532766 0.013244502856960898088 -0.001709793130214199916 -0.0043788035158747479897 -0.0028480233398403809707 -0.0093915345870211226764 -0.008103176740654855284 -0.0076174677926633474478 -0.0077766377734104731242 -0.004346794127327914016 -0.0048642578567762127795 -0.0035875668173102419865 -0.0026791878247931985579 -0.0031985860480012750541 -0.0018742874698567516846;0.088050307078912939951 -0.40934326286578465171 -0.26455787524515700371 0.081458723502245991566 0.17222275864898314857 0.24248721075576556983 0.26260815849820706713 0.15241497864888881031 0.11015347617950914383 0.05126371750561448809 0.012009168435707031838 -0.030391503949313891653 -0.066107572789370128152 -0.080709320520580218883 -0.16222499040731516717 -0.15557117662132863289 -0.099510801416301142286 -0.082354423236067411662 -0.035733079637845825693 -0.0046705557722405968354 -0.0046752208803079488286 -0.051877542571668142091 -0.058607346104495118555 -0.053215221571177140358 -0.043999606849316238999 -0.011905156667288788533 -0.05513418695506475814 -0.078088428975465057347 -0.066107162612543401981 -0.033918947452394036801 -0.05343982363937544583 -0.064315132305793179524 -0.013075857090633935878 0.0060220250422963498768 0.0159370608627862273 -0.013068700014006888466 -0.015869734548645736405 -0.00115188871800086883 0.00058074885269085809759 0.0023389794831983304509 0.017980273109697145206 0.015056140982953819876 0.019416479758701563757 0.021403396345394381378 0.010046315108873169267 0.0091024476813506265821 0.0055186524586937823686 0.0045605242021541916517 0.0078603323244920489388 0.0027104712420585597155];

% Layer 2
b2 = -393.26610739643973602;
LW2_1 = [2394.5673760946779112 691.91024877111362912 355.09273087614866427 -819.29710371320811646 1081.4745846334055841 5.5650239980445199706 553.14121965597018971];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0133333968405505;
y1_step1.xoffset = 50.0002839662537;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
